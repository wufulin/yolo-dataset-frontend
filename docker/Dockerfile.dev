# =============================================================================
# Development environment features
# =============================================================================

# 1. Enable hot reload
# 2. Install development tools

# =============================================================================
# Usage
# =============================================================================

# Build development image:
# docker build -f docker/Dockerfile.dev -t yolo-frontend:dev .

# Run with environment variables:
# docker run -p 3000:3000 \
#   -e NEXT_PUBLIC_API_URL=http://localhost:8000 \
#   -e NEXT_PUBLIC_MINIO_ENDPOINT=http://localhost:9000 \
#   -v $(pwd):/app yolo-frontend:dev

FROM node:20-alpine

# Set environment variables
ENV NODE_ENV=development
ENV NEXT_TELEMETRY_DISABLED=1

# Install development dependencies
RUN apk add --no-cache \
    curl \
    git

# Set working directory
WORKDIR /app

# Copy package files
COPY package*.json ./

# Install all dependencies (including devDependencies)
RUN npm install

# Copy source code
COPY . .

# Create non-root user
RUN addgroup -g 1001 -S nodejs && \
    adduser -S nextjs -u 1001 && \
    chown -R nextjs:nodejs /app

# Switch to non-root user
USER nextjs

# Expose port
EXPOSE 3000

# Development environment start command (hot reload)
CMD ["npm", "run", "dev"]